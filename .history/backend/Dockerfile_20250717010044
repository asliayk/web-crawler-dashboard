# Dockerfile
FROM golang:1.21-alpine AS builder
WORKDIR /app

# 1) Copy go.mod/go.sum and download deps
COPY go.mod go.sum ./
RUN go mod download

# 2) Copy all source files
COPY . .

# 3) Build the binary (the "." tells Go to include every .go in this dir)
RUN go build -o server .

# ---- final image ----
FROM alpine:3.18
WORKDIR /app
COPY --from=builder /app/server .

EXPOSE 8080
CMD ["./server"]
