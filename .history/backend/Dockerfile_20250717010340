# Dockerfile
FROM golang:1.21-alpine AS builder
WORKDIR /app

# 1) Only copy go.mod
COPY go.mod ./

# 2) Download dependencies & create go.sum inâ€‘image
RUN go mod tidy

# 3) Copy all source files
COPY . .

# 4) Build the binary
RUN go build -o server .

# ---- final image ----
FROM alpine:3.18
WORKDIR /app
COPY --from=builder /app/server .

EXPOSE 8080
CMD ["./server"]
